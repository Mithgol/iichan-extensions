!function(){"use strict";var e=50,t="iichan_hidden_threads",n="iichan-hide-thread-btn",r="iichan-thread-hidden",a="iichan-hidden-thread-placeholder",i=window.location.href.match(/(?:\w+\.\w+\/)(.*)(?=\/)/)[1],d=function(){var e=JSON.parse(window.localStorage.getItem(t)||"{}");return Array.isArray(e)?{}:e},o=function(e){window.localStorage.setItem(t,JSON.stringify(e))},c=function(e,t){var n=d();if(n[i]||(n[i]=[]),t)n[i].includes(e)||n[i].push(e);else{var r=n[i].indexOf(e);if(r===-1)return;n[i].splice(r,1)}o(n)},l=function(e){if(e){var t=e.querySelector(":scope > label");if(t){var r=document.createElement("span");r.title="Скрыть тред",r.classList.add(n),r.dataset.threadId=e.id,r.addEventListener("click",f),e.insertBefore(r,t.nextSibling)}}},s=function(e){if(e){var t=document.createElement("div");t.title="Скрыть тред",t.classList.add(n,"reply"),t.dataset.threadId=e.id,t.addEventListener("click",y),e.querySelector(".catthread").appendChild(t)}},u=function(t){if(t){var n=t.id.split("-").pop(),r=t.querySelector(".filetitle").innerText||t.querySelector("blockquote").innerText;r=r.substr(0,e);var i="iichan-hidden-"+t.id;t.insertAdjacentHTML("beforebegin",'\n      <div class="reply '+a+'" id="'+i+'">Тред <a>№'+n+"</a> скрыт ("+(r||"изображение")+")</div>\n    ");var d=t.previousElementSibling.querySelector(":scope > a");d.dataset.threadId=t.id,d.addEventListener("click",v)}},h=function(e){var t=!!document.querySelector(".catthreadlist"),n=t?".catthreadlist a":"[id^=thread]",r=e&&e.id.startsWith("thread-")?[e]:(e||document).querySelectorAll(n),a=t?s:l,o=d(),c=!0,u=!1,h=void 0;try{for(var v,y=r[Symbol.iterator]();!(c=(v=y.next()).done);c=!0){var p=v.value;p.id=t?"thread-"+p.title.match(/^#(\d+)\s/)[1]:p.id,a(p),o[i]&&o[i].includes(p.id)&&f(p.id)}}catch(e){u=!0,h=e}finally{try{!c&&y.return&&y.return()}finally{if(u)throw h}}},v=function(e){var t=e.target?e.target.dataset.threadId:e;c(t,!1);var n=document.getElementById(t);if(n){n.classList.remove(r);var a=document.getElementById("iichan-hidden-"+t);a&&a.parentElement.removeChild(a)}},f=function(e){var t=e.target?e.target.dataset.threadId:e;c(t,!0);var n=document.getElementById(t);if(n&&n.parentNode){n.classList.add(r);var a=!!document.querySelector(".catthreadlist");a||u(n)}},y=function(e){var t=e.target?e.target.dataset.threadId:e,n=t.split("-").pop(),a=document.getElementById("thread-"+n);c(t,a.classList.toggle(r)),e.preventDefault&&e.preventDefault()},p=function(){document.head.insertAdjacentHTML("beforeend",'<style type="text/css">\n        .'+a+" {\n            pointer-events: none;\n        }\n        \n        ."+a+" a {\n            cursor: pointer;\n            pointer-events: auto;\n        }\n        \n        ."+a+":hover + div,\n        ."+a+":hover + div + br {\n            display: block !important;\n        }\n        \n        ."+a+" + div {\n            display: none;\n        }\n        ."+a+" + div +  br {\n            display: none;\n        }\n        \n        ."+n+" {\n            margin-left: 0.2em;\n            cursor: pointer;\n        }\n        \n        ."+n+"::after {\n            content: '[✕]';\n        }\n        \n        .catthreadlist a {\n          position: relative;\n          transition: all .3s ease-in-out;\n        }\n        \n        .catthreadlist ."+r+" {\n          opacity: .6;\n        }\n        \n        .catthreadlist ."+r+":not(:hover) {\n          opacity: .2;\n          filter: blur(1px);\n        }\n        \n        .catthread:hover ."+n+" {\n          display: block;\n        }\n        \n        .catthread ."+n+" {\n          text-decoration: none;\n          position: absolute;\n          top: 0;\n          right: 0;\n          display: none;\n          width: 25px;\n          height: 25px;\n        }\n        \n        .catthreadlist ."+r+" ."+n+"::after {\n          content: '[┼]';\n        }\n      </style>")},m=function(){if(!document.querySelector("#de-main")&&!document.querySelector("body.replypage")&&(p(),h(),"MutationObserver"in window)){var e=new MutationObserver(function(e){e.forEach(function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=e.addedNodes[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var d=a.value;if(!d.querySelectorAll)return;h(d)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}})});e.observe(document.body,{childList:!0,subtree:!0})}};document.body?m():document.addEventListener("DOMContentLoaded",m)}();