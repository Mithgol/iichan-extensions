(()=>{"use strict";const e=()=>{if(!document.querySelector("#de-main")){const e=document.querySelector("input[name=captcha]");e&&e.addEventListener("keypress",e=>{const t="йцукенгшщзхъїфыівапролджэєячсмитьбюёґ",n="qwertyuiop[]]assdfghjkl;''zxcvbnm,.`\\";let o,c=e.charCode||e.keyCode,r=String.fromCharCode(c).toLowerCase();if(!(c<1040||c>1279||(o=t.indexOf(r))===-1)){r=n[o];const t=e.target,c=r,i=t.scrollTop,d=t.selectionStart;t.value=t.value.substr(0,d)+c+t.value.substr(t.selectionEnd),t.setSelectionRange(d+c.length,d+c.length),t.focus(),t.scrollTop=i,e.preventDefault()}})}};document.body?e():document.addEventListener("DOMContentLoaded",e)})(),(()=>{"use strict";const e="(min-width: 10cm)",t=["jpg","jpeg","gif","png"],n=t=>{if(window.matchMedia(e).matches){const e=t.currentTarget.querySelector(".thumb"),n=e.src==e.dataset.fullSrc;e.setAttribute("width",n?e.dataset.thumbWidth:e.dataset.fullWidth),e.setAttribute("height",n?e.dataset.thumbHeight:e.dataset.fullHeight),e.src=n?e.dataset.thumbSrc:e.dataset.fullSrc,t.preventDefault()}},o=e=>{const o=(e||document).querySelectorAll(".thumb");for(const c of o){const e=c.parentNode;if(e){const o=e.href.match(/\w*$/).toString();if(t.includes(o)){c.dataset.thumbWidth=c.getAttribute("width"),c.dataset.thumbHeight=c.getAttribute("height"),c.dataset.thumbSrc=c.src,c.dataset.fullSrc=e.href;const t=e.parentNode;if(t){const o=t.querySelector(".filesize > em");if(o){const t=o.innerText.match(/(\d*)x(\d*)/);c.dataset.fullWidth=t[1],c.dataset.fullHeight=t[2],e.addEventListener("click",n)}}}}}},c=()=>{document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .thumb {
          max-width: 100%;
          height: auto;
          box-sizing: border-box;
          margin: 0;
          padding: 2px 20px
        }
      </style>`)},r=()=>{if(!document.querySelector("#de-main")){c(),o();const e=new MutationObserver(e=>{e.forEach(e=>{for(const t of e.addedNodes){if(!t.querySelectorAll)return;o(t)}})});e.observe(document.body,{childList:!0,subtree:!0})}};document.body?r():document.addEventListener("DOMContentLoaded",r)})(),(()=>{"use strict";const e=50,t="iichan_hidden_threads",n="iichan-hide-thread-btn",o="iichan-hidden-thread-placeholder",c=window.location.href.match(/(?:\w+\.\w+\/)(.*)(?=\/)/)[1],r=()=>{const e=JSON.parse(window.localStorage.getItem(t)||"{}");return Array.isArray(e)?{}:e},i=e=>{window.localStorage.setItem(t,JSON.stringify(e))},d=e=>{const t=e&&e.id.startsWith("thread-")?[e]:(e||document).querySelectorAll("[id^=thread]");for(const o of t){const e=o.querySelector(":scope > label");if(e){e.insertAdjacentHTML("afterend",`
        <span class="${n}" title="Скрыть тред"></span>
      `);const t=e.nextElementSibling;t.threadId=o.id,t.addEventListener("click",u)}}},s=e=>{const t="object"==typeof e?e.target.threadId:e,n=r();n[c]||(n[c]=[]);const o=n[c].indexOf(t);if(o!==-1){n[c].splice(o,1),i(n);const e=document.getElementById(t);if(e){const e=document.getElementById("iichan-hidden-"+t);e&&e.parentElement.removeChild(e)}}},u=t=>{const n="object"==typeof t?t.target.threadId:t,d=document.getElementById(n);if(d&&d.parentNode){const t=n.split("-")[1];let u=d.querySelector(".filetitle").innerText||d.querySelector("blockquote").innerText;u=u.substr(0,e);const a="iichan-hidden-"+n;d.insertAdjacentHTML("beforebegin",`
      <div class="reply ${o}" id="${a}">Тред <a>№${t}</a> скрыт (${u||"изображение"})</div>
    `);const l=d.previousElementSibling.querySelector(":scope > a");l.threadId=n,l.addEventListener("click",s);const f=r();f[c]||(f[c]=[]),f[c].includes(n)||(f[c].push(n),i(f))}},a=()=>{const e=r();if(e[c])for(const t of e[c])u(t)},l=()=>{document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .${o} {
            pointer-events: none;
        }
        
        .${o} a {
            cursor: pointer;
            pointer-events: auto;
        }
        
        .${o}:hover + div,
        .${o}:hover + div + br {
            display: block !important;
        }
        
        .${o} + div {
            display: none;
        }
        .${o} + div +  br {
            display: none;
        }
        
        .${n} {
            margin-left: 0.2em;
            cursor: pointer;
        }
        
        .${n}::after {
            content: '[✕]';
        }
      </style>`)},f=()=>{if(!document.querySelector("#de-main")){const e=document.querySelectorAll("[id^=thread]");if(!(e.length<=1)){l(),d(),a();const e=new MutationObserver(e=>{e.forEach(e=>{for(const t of e.addedNodes){if(!t.querySelectorAll)return;d(t)}})});e.observe(document.body,{childList:!0,subtree:!0})}}};document.body?f():document.addEventListener("DOMContentLoaded",f)})(),(()=>{"use strict";const e=["webm","mp4","ogv"],t="iichan-video-player",n=e=>{const n=e.currentTarget.parentNode,o=document.createElement("video");o.src=e.currentTarget.href,o.classList.add(t),n.insertBefore(o,e.currentTarget),n.removeChild(e.currentTarget),e.preventDefault()},o=t=>{const o=(t||document).querySelectorAll(".thumb");for(const c of o){const t=c.parentNode;if(t){const o=t.href.split(".").pop();e.includes(o)&&t.addEventListener("click",n)}}},c=()=>{document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .iichan-video-player {
          max-width: 100%;
          height: auto;
          box-sizing: border-box;
          margin: 0;
          padding: 2px 20px
        }
      </style>`)},r=()=>{if(!document.querySelector("#de-main")){c(),o();const e=new MutationObserver(e=>{e.forEach(e=>{for(const t of e.addedNodes){if(!t.querySelectorAll)return;o(t)}})});e.observe(document.body,{childList:!0,subtree:!0})}};document.body?r():document.addEventListener("DOMContentLoaded",r)})();