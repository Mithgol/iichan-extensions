!function(){"use strict";function e(){let e=document.querySelector("input[name=captcha]");e&&e.addEventListener("keypress",function(e){const t="йцукенгшщзхъїфыівапролджэєячсмитьбюёґ",n="qwertyuiop[]]assdfghjkl;''zxcvbnm,.`\\";let i,o=e.charCode||e.keyCode,d=String.fromCharCode(o).toLowerCase();if(!(o<1040||o>1279||(i=t.indexOf(d))===-1)){d=n[i];let t=e.target,o=d,c=t.scrollTop,r=t.selectionStart;t.value=t.value.substr(0,r)+o+t.value.substr(t.selectionEnd),t.setSelectionRange(r+o.length,r+o.length),t.focus(),t.scrollTop=c,e.preventDefault()}})}document.body?e():document.addEventListener("DOMContentLoaded",e)}(),function(){"use strict";function e(e){function t(e){if(window.matchMedia(i).matches){const t=e.currentTarget.querySelector(".thumb"),n=t.classList.toggle(d);n?(t.removeAttribute("width"),t.removeAttribute("height")):(t.setAttribute("width",t.thumbWidth),t.setAttribute("height",t.thumbHeight)),t.src=n?e.currentTarget.href:t.thumbSrc,e.preventDefault()}}const n=document.querySelectorAll(".thumb");for(let c of n){let e=c.parentNode;if(e){let n=e.href.match(/\w*$/).toString();o.includes(n)&&(c.thumbWidth=c.getAttribute("width"),c.thumbHeight=c.getAttribute("height"),c.thumbSrc=c.src,e.addEventListener("click",t))}}}function t(){document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .iichan-image-fullsize {
            max-width: calc(100% - 42px);
        }
      </style>`)}function n(){t(),e()}const i="(min-width: 10cm)",o=["jpg","jpeg","gif","png"],d="iichan-image-fullsize";document.body?n():document.addEventListener("DOMContentLoaded",n)}(),function(){"use strict";function e(){const e=JSON.parse(window.localStorage.getItem(l)||"{}");return Array.isArray(e)?{}:e}function t(e){window.localStorage.setItem(l,JSON.stringify(e))}function n(){let e=document.querySelectorAll("[id^=thread]");for(let t of e){let e=t.querySelector(":scope > label");if(e){e.insertAdjacentHTML("afterend",`
        <span class="${s}" title="Скрыть тред"></span>
      `);let n=e.nextElementSibling;n.threadId=t.id,n.addEventListener("click",o)}}}function i(n){let i="object"==typeof n?n.target.threadId:n,o=e();o[m]||(o[m]=[]);let d=o[m].indexOf(i);if(d!==-1){o[m].splice(d,1),t(o);let e=document.getElementById(i);if(e){e.classList.remove(a);let t=document.getElementById("iichan-hidden-"+i);t&&t.parentElement.removeChild(t)}}}function o(n){let o="object"==typeof n?n.target.threadId:n,d=document.getElementById(o);if(d&&d.parentNode){let n=o.split("-")[1],c=d.querySelector(".filetitle").innerText||d.querySelector("blockquote").innerText;c=c.substr(0,u);let r="iichan-hidden-"+o;d.insertAdjacentHTML("beforebegin",`
      <div class="reply ${h}" id="${r}">Тред <a>№${n}</a> скрыт (${c||"изображение"})</div>
    `);let l=d.previousElementSibling.querySelector(":scope > a");l.threadId=o,l.addEventListener("click",i),d.classList.add(a);let s=e();s[m]||(s[m]=[]),s[m].includes(o)||(s[m].push(o),t(s))}}function d(){let t=e();if(t[m])for(let n of t[m])o(n)}function c(){document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .${h} {
            pointer-events: none;
        }
        
        .${h} a {
            cursor: pointer;
            pointer-events: auto;
        }
        
        .${h}:hover + div,
        .${h}:hover + div + br {
            display: block !important;
        }
        
        .iichan-thread-hidden {
            display: none;
        }
        .iichan-thread-hidden +  br {
            display: none;
        }
        
        .${s} {
            margin-left: 0.2em;
            cursor: pointer;
        }
        
        .${s}::after {
            content: '[✕]';
        }
      </style>`)}function r(){const e=document.querySelectorAll("[id^=thread]");e.length<=1||(c(),n(),d())}const u=50,l="iichan_hidden_threads",a="iichan-thread-hidden",s="iichan-hide-thread-btn",h="iichan-hidden-thread-placeholder",m=window.location.href.match(/(?:\w+\.\w+\/)(.*)(?=\/)/)[1];document.body?r():document.addEventListener("DOMContentLoaded",r)}(),function(){"use strict";function e(){document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .reply-popup {
        \tborder: 1px solid currentColor;
        }
      </style>`)}function t(){let t=null;const i=e=>{if(!document.querySelector("#de-main")){const i=e.target.innerText.match(/\d+/).toString(),o=document.querySelector(`#reply${i}`);o&&(t=document.createElement("div"),t.innerHTML=o.innerHTML,t.classList.add("reply"),t.classList.add("reply-popup"),t.style.position="fixed",t.style.left=e.clientX+n.x+"px",t.style.top=e.clientY+n.y+"px",document.body.appendChild(t))}},o=e=>{document.querySelector("#de-main")||t&&(document.body.removeChild(t),t=null)},d=e=>{document.querySelector("#de-main")||t&&(t.style.left=e.clientX+n.x+"px",t.style.top=e.clientY+n.y+"px")};if(!document.querySelector("#de-main")){const t=document.querySelectorAll('a[onclick^="highlight"]');if(t.length){e();for(let n of t)n.addEventListener("mouseenter",i),n.addEventListener("mouseleave",o),n.addEventListener("mousemove",d)}}}const n={x:5,y:5};document.body?t():document.addEventListener("DOMContentLoaded",t)}();