(()=>{"use strict";const e=()=>{if(!document.querySelector("#de-main")){const e=document.querySelector("input[name=captcha]");e&&e.addEventListener("keypress",e=>{const t="йцукенгшщзхъїфыівапролджэєячсмитьбюёґ",n="qwertyuiop[]]assdfghjkl;''zxcvbnm,.`\\";let c,o=e.charCode||e.keyCode,d=String.fromCharCode(o).toLowerCase();if(!(o<1040||o>1279||(c=t.indexOf(d))===-1)){d=n[c];const t=e.target,o=d,i=t.scrollTop,r=t.selectionStart;t.value=t.value.substr(0,r)+o+t.value.substr(t.selectionEnd),t.setSelectionRange(r+o.length,r+o.length),t.focus(),t.scrollTop=i,e.preventDefault()}})}};document.body?e():document.addEventListener("DOMContentLoaded",e)})(),(()=>{"use strict";const e="(min-width: 10cm)",t=["jpg","jpeg","gif","png"],n=t=>{if(window.matchMedia(e).matches){const e=t.currentTarget.querySelector(".thumb"),n=e.src==e.dataset.fullSrc;e.setAttribute("width",n?e.dataset.thumbWidth:e.dataset.fullWidth),e.setAttribute("height",n?e.dataset.thumbHeight:e.dataset.fullHeight),e.src=n?e.dataset.thumbSrc:e.dataset.fullSrc,t.preventDefault()}},c=e=>{const c=(e||document).querySelectorAll(".thumb");for(const o of c){const e=o.parentNode;if(e){const c=e.href.match(/\w*$/).toString();if(t.includes(c)){o.dataset.thumbWidth=o.getAttribute("width"),o.dataset.thumbHeight=o.getAttribute("height"),o.dataset.thumbSrc=o.src,o.dataset.fullSrc=e.href;const t=e.parentNode;if(t){const c=t.querySelector(".filesize > em");if(c){const t=c.innerText.match(/(\d*)x(\d*)/);o.dataset.fullWidth=t[1],o.dataset.fullHeight=t[2],e.addEventListener("click",n)}}}}}},o=()=>{document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .thumb {
          max-width: 100%;
          height: auto;
          box-sizing: border-box;
          margin: 0;
          padding: 2px 20px
        }
      </style>`)},d=()=>{if(!document.querySelector("#de-main")){o(),c();const e=new MutationObserver(e=>{e.forEach(e=>{for(const t of e.addedNodes){if(!t.querySelectorAll)return;c(t)}})});e.observe(document.body,{childList:!0,subtree:!0})}};document.body?d():document.addEventListener("DOMContentLoaded",d)})(),(()=>{"use strict";const e=50,t="iichan_hidden_threads",n="iichan-hide-thread-btn",c="iichan-thread-hidden",o="iichan-hidden-thread-placeholder",d=window.location.href.match(/(?:\w+\.\w+\/)(.*)(?=\/)/)[1],i=()=>{const e=JSON.parse(window.localStorage.getItem(t)||"{}");return Array.isArray(e)?{}:e},r=e=>{window.localStorage.setItem(t,JSON.stringify(e))},a=(e,t)=>{const n=i();if(n[d]||(n[d]=[]),t)n[d].includes(e)||n[d].push(e);else{const t=n[d].indexOf(e);if(t===-1)return;n[d].splice(t,1)}r(n)},s=e=>{if(e){const t=e.querySelector(":scope > label");if(t){const c=document.createElement("span");c.title="Скрыть тред",c.classList.add(n),c.dataset.threadId=e.id,c.addEventListener("click",m),e.insertBefore(c,t.nextSibling)}}},u=e=>{if(e){const t=document.createElement("div");t.title="Скрыть тред",t.classList.add(n,"reply"),t.dataset.threadId=e.id,t.addEventListener("click",b),e.querySelector(".catthread").appendChild(t)}},l=t=>{if(t){const n=t.id.split("-").pop();let c=t.querySelector(".filetitle").innerText||t.querySelector("blockquote").innerText;c=c.substr(0,e);const d="iichan-hidden-"+t.id;t.insertAdjacentHTML("beforebegin",`
      <div class="reply ${o}" id="${d}">Тред <a>№${n}</a> скрыт (${c||"изображение"})</div>
    `);const i=t.previousElementSibling.querySelector(":scope > a");i.dataset.threadId=t.id,i.addEventListener("click",h)}},f=e=>{const t=!!document.querySelector(".catthreadlist"),n=t?".catthreadlist a":"[id^=thread]",c=e&&e.id.startsWith("thread-")?[e]:(e||document).querySelectorAll(n),o=t?u:s,r=i();for(const a of c)a.id=t?"thread-"+a.title.match(/^#(\d+)\s/)[1]:a.id,o(a),r[d]&&r[d].includes(a.id)&&m(a.id)},h=e=>{const t=e.target?e.target.dataset.threadId:e;a(t,!1);const n=document.getElementById(t);if(n){n.classList.remove(c);const e=document.getElementById("iichan-hidden-"+t);e&&e.parentElement.removeChild(e)}},m=e=>{const t=e.target?e.target.dataset.threadId:e;a(t,!0);const n=document.getElementById(t);if(n&&n.parentNode){n.classList.add(c);const e=!!document.querySelector(".catthreadlist");e||l(n)}},b=e=>{const t=e.target?e.target.dataset.threadId:e,n=t.split("-").pop(),o=document.getElementById("thread-"+n);a(t,o.classList.toggle(c)),e.preventDefault&&e.preventDefault()},g=()=>{document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .${o} {
            pointer-events: none;
        }
        
        .${o} a {
            cursor: pointer;
            pointer-events: auto;
        }
        
        .${o}:hover + div,
        .${o}:hover + div + br {
            display: block !important;
        }
        
        .${o} + div {
            display: none;
        }
        .${o} + div +  br {
            display: none;
        }
        
        .${n} {
            margin-left: 0.2em;
            cursor: pointer;
        }
        
        .${n}::after {
            content: '[✕]';
        }
        
        .catthreadlist a {
          position: relative;
          transition: all .3s ease-in-out;
        }
        
        .catthreadlist .iichan-thread-hidden {
          opacity: .6;
        }
        
        .catthreadlist .iichan-thread-hidden:not(:hover) {
          opacity: .2;
          filter: blur(1px);
        }
        
        .catthread:hover .${n} {
          display: block;
        }
        
        .catthread .${n} {
          text-decoration: none;
          position: absolute;
          top: 0;
          right: 0;
          display: none;
          width: 25px;
          height: 25px;
        }
        
        .catthreadlist .iichan-thread-hidden .${n}::after {
          content: '[┼]';
        }
      </style>`)},p=()=>{if(!document.querySelector("#de-main")&&!document.querySelector("body.replypage")){g(),f();const e=new MutationObserver(e=>{e.forEach(e=>{for(const t of e.addedNodes){if(!t.querySelectorAll)return;f(t)}})});e.observe(document.body,{childList:!0,subtree:!0})}};document.body?p():document.addEventListener("DOMContentLoaded",p)})(),(()=>{"use strict";const e=["webm","mp4","ogv"],t="iichan-video-player",n=e=>{const n=e.currentTarget.parentNode,c=document.createElement("video");c.src=e.currentTarget.href,c.classList.add(t),n.insertBefore(c,e.currentTarget),n.removeChild(e.currentTarget),e.preventDefault()},c=t=>{const c=(t||document).querySelectorAll(".thumb");for(const o of c){const t=o.parentNode;if(t){const c=t.href.split(".").pop();e.includes(c)&&t.addEventListener("click",n)}}},o=()=>{document.head.insertAdjacentHTML("beforeend",`<style type="text/css">
        .iichan-video-player {
          max-width: 100%;
          height: auto;
          box-sizing: border-box;
          margin: 0;
          padding: 2px 20px
        }
      </style>`)},d=()=>{if(!document.querySelector("#de-main")){o(),c();const e=new MutationObserver(e=>{e.forEach(e=>{for(const t of e.addedNodes){if(!t.querySelectorAll)return;c(t)}})});e.observe(document.body,{childList:!0,subtree:!0})}};document.body?d():document.addEventListener("DOMContentLoaded",d)})();